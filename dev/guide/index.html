<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Guide · SimplexPlots.jl</title><meta name="title" content="Guide · SimplexPlots.jl"/><meta property="og:title" content="Guide · SimplexPlots.jl"/><meta property="twitter:title" content="Guide · SimplexPlots.jl"/><meta name="description" content="Documentation for SimplexPlots.jl."/><meta property="og:description" content="Documentation for SimplexPlots.jl."/><meta property="twitter:description" content="Documentation for SimplexPlots.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="SimplexPlots.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">SimplexPlots.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Guide</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#Installation-and-usage"><span>Installation and usage</span></a></li><li><a class="tocitem" href="#Scatterplots-and-lineplots"><span>Scatterplots and lineplots</span></a></li><li><a class="tocitem" href="#Histograms"><span>Histograms</span></a></li><li><a class="tocitem" href="#Heatmaps"><span>Heatmaps</span></a></li><li><a class="tocitem" href="#Adding-to-plots"><span>Adding to plots</span></a></li><li class="toplevel"><a class="tocitem" href="#Axis-orientation"><span>Axis orientation</span></a></li></ul></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Guide</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Guide</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/hkauhanen/SimplexPlots.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/hkauhanen/SimplexPlots.jl/blob/main/docs/src/guide.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Guide"><a class="docs-heading-anchor" href="#Guide">Guide</a><a id="Guide-1"></a><a class="docs-heading-anchor-permalink" href="#Guide" title="Permalink"></a></h1><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>Mathematically, the <span>$(n-1)$</span>-dimensional simplex is the subset of <span>$\mathbb{R}^n$</span> whose points <span>$\mathbf{x} = (x_1, \ldots , x_n)$</span> satisfy the following conditions:</p><ol><li><span>$x_i \geq 0$</span> for all <span>$i = 1, \ldots , n$</span></li><li><span>$\sum_{i=1}^n x_i = 1$</span></li></ol><p>In the <span>$n=3$</span> case, this set looks as follows:</p><p><img src="../assets/simplex3D-1.png" alt/></p><p>Since the simplex itself is a two-dimensional structure in this case, we can &quot;lift&quot; it out of the three-dimensional Euclidean space and visualize it in the plane:</p><p><img src="../assets/simplex-1.png" alt/></p><p>Each vertex of this triangle corresponds to one of the standard basis vectors of <span>$\mathbb{R}^3$</span>, i.e. <span>$x_i = 1$</span> for some <span>$i$</span> (and, by implication, <span>$x_j = 0$</span> for all <span>$j \neq i$</span>). The point in the middle is the <em>maximum-entropy state</em> or <em>barycentre</em> <span>$(1/3, 1/3, 1/3)$</span>.</p><p>One may equivalently think of the simplex as the set of all possible categorical probability distributions over <span>$n$</span> options, such that <span>$x_i$</span> gives the probability of the <span>$i$</span>th option.</p><h2 id="Installation-and-usage"><a class="docs-heading-anchor" href="#Installation-and-usage">Installation and usage</a><a id="Installation-and-usage-1"></a><a class="docs-heading-anchor-permalink" href="#Installation-and-usage" title="Permalink"></a></h2><p>To install SimplexPlots.jl:</p><pre><code class="language-julia hljs">]add https://github.com/hkauhanen/SimplexPlots.jl</code></pre><p>To load it:</p><pre><code class="language-julia hljs">using Plots
using SimplexPlots</code></pre><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>SimplexPlots.jl does not import routines defined in Plots.jl. In practical terms, this means that if you wish to make use of functionality provided by the latter (such as saving figures into files) you will need to be <code>using</code> both packages, as above.</p></div></div><h2 id="Scatterplots-and-lineplots"><a class="docs-heading-anchor" href="#Scatterplots-and-lineplots">Scatterplots and lineplots</a><a id="Scatterplots-and-lineplots-1"></a><a class="docs-heading-anchor-permalink" href="#Scatterplots-and-lineplots" title="Permalink"></a></h2><p>The functions <code>simplex_scatter</code> and <code>simplex_plot</code> accept a column vector, a row vector, a matrix, or a vector of column vectors as input:</p><pre><code class="language-julia hljs">myvector = [0.1, 0.1, 0.8]

simplex_scatter(myvector)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">GKS: cannot open display - headless operation mode active</code></pre><p><img src="../scatter1.png" alt/></p><pre><code class="language-julia hljs">myvector = [0.1 0.1 0.8]

simplex_scatter(myvector)</code></pre><p><img src="../scatter1b.png" alt/></p><pre><code class="language-julia hljs">mymatrix = [0.1 0.1 0.8
            0.1 0.8 0.1
            0.8 0.1 0.1]

simplex_scatter(mymatrix)</code></pre><p><img src="../scatter2.png" alt/></p><pre><code class="language-julia hljs">myvecs = [[0.1, 0.1, 0.8], [0.1, 0.8, 0.1], [0.8, 0.1, 0.1]]

simplex_scatter(myvecs)</code></pre><p><img src="../scatter2b.png" alt/></p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This multitude of input formats is deliberate, as it allows the output of many kinds of data-generating routines to be fed directly into SimplexPlots.jl. We will see examples of this throughout the Guide.</p><p>Internally, all input types are transformed into a matrix of three columns before plotting.</p></div></div><p>These functions accept the arguments accepted by Plots.jl&#39;s <code>plot</code> and <code>scatter</code>. For instance:</p><pre><code class="language-julia hljs">mymatrix = [0.1 0.1 0.8
            0.3 0.4 0.3
            0.2 0.6 0.2
            0.1 0.7 0.2
            0.0 0.8 0.2
            0.0 1.0 0.0]

simplex_plot(mymatrix; label=nothing, linewidth=4.0, color=:blue)</code></pre><p><img src="../scatter3.png" alt/></p><p>Furthermore, a <code>vertices</code> keyword argument is provided which sets the labels on the vertices of the simplex. For instance:</p><pre><code class="language-julia hljs">using LaTeXStrings

mymatrix = [0.1 0.1 0.8
            0.3 0.4 0.3
            0.2 0.6 0.2
            0.1 0.7 0.2
            0.0 0.8 0.2
            0.0 1.0 0.0]

simplex_plot(mymatrix; label=nothing, linewidth=4.0, color=:blue,
                       vertices = [L&quot;x_1&quot;, L&quot;x_2&quot;, L&quot;x_3&quot;])</code></pre><p><img src="../scatter4.png" alt/></p><p>For a more interesting example, let&#39;s plot the solution of a dynamical system.</p><pre><code class="language-julia hljs"># we will use DifferentialEquations.jl to obtain the solution
# (see https://docs.sciml.ai/DiffEqDocs/stable/getting_started/)
using DifferentialEquations
using LinearAlgebra

# the replicator dynamic (see https://en.wikipedia.org/wiki/Replicator_equation)
replicator(u, A, t) = u .* (A*u .- transpose(u)*A*u)

# rock-paper-scissors payoff matrix
RPS = [ 0  -1   1
        1   0  -1
       -1   1   0 ]

# set up the problem
u0 = [0.2, 0.2, 0.6]
tspan = (0.0, 15.0)
prob = ODEProblem(replicator, u0, tspan, RPS)

# obtain solution
sol = solve(prob, saveat=0.1)

# plot solution
simplex_plot(sol.u;
             vertices = [L&quot;u_1&quot;, L&quot;u_2&quot;, L&quot;u_3&quot;],
             color = :black,
             linewidth = 3.0,
             title = &quot;Rock-Paper-Scissors in Replicator Dynamics&quot;,
             label = nothing)</code></pre><p><img src="../solution.png" alt/></p><h2 id="Histograms"><a class="docs-heading-anchor" href="#Histograms">Histograms</a><a id="Histograms-1"></a><a class="docs-heading-anchor-permalink" href="#Histograms" title="Permalink"></a></h2><p>To illustrate the plotting of histograms, we will create a <a href="https://en.wikipedia.org/wiki/Dirichlet_distribution">Dirichlet distribution</a> and sample random variates from it. Here is the definition of the distribution:</p><pre><code class="language-julia hljs">using Distributions

dir = Dirichlet(5 .* ones(3))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Distributions.Dirichlet{Float64, Vector{Float64}, Float64}(alpha=[5.0, 5.0, 5.0])</code></pre><p>Random variates can be obtained using the <code>rand</code> function. To obtain, say, 10,000 random vectors, we call:</p><pre><code class="language-julia hljs">some_random_vectors = rand(dir, 10_000)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3×10000 Matrix{Float64}:
 0.304563  0.365742  0.282492  0.432427  …  0.274972  0.226087  0.370597
 0.175669  0.17579   0.395998  0.388697     0.314633  0.255433  0.341641
 0.519768  0.458468  0.321509  0.178877     0.410395  0.51848   0.287762</code></pre><p>These can be passed to <code>simplex_histogram</code> to obtain a histogram:</p><pre><code class="language-julia hljs">simplex_histogram(some_random_vectors)</code></pre><p><img src="../histo1.png" alt/></p><p>Adding more random vectors gives us a smoother picture of the underlying distribution:</p><pre><code class="language-julia hljs">simplex_histogram(rand(dir, 100_000))</code></pre><p><img src="../histo2.png" alt/></p><p>The <code>bins</code> keyword argument can be used to control the number of triangular histogram bins:</p><pre><code class="language-julia hljs">simplex_histogram(rand(dir, 100_000); bins=10)</code></pre><p><img src="../histo3.png" alt/></p><pre><code class="language-julia hljs">simplex_histogram(rand(dir, 1_000_000); bins=100)</code></pre><p><img src="../histo4.png" alt/></p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Technically, <code>bins</code> is not the number of bins in the simplex, but rather  the &quot;resolution&quot; along any of its three sides.)</p></div></div><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Expect long execution times when the number of bins is large!</p></div></div><p>The <code>vertices</code> and <code>color</code> arguments can be used to change the labelling of the vertices and the color gradient:</p><pre><code class="language-julia hljs">using LaTeXStrings

simplex_histogram(rand(dir, 10_000);
                  bins=20,
                  vertices = [L&quot;\xi_1&quot;, L&quot;\xi_2&quot;, L&quot;\xi_3&quot;],
                  color = :Pastel1_3)</code></pre><p><img src="../histo5.png" alt/></p><h2 id="Heatmaps"><a class="docs-heading-anchor" href="#Heatmaps">Heatmaps</a><a id="Heatmaps-1"></a><a class="docs-heading-anchor-permalink" href="#Heatmaps" title="Permalink"></a></h2><p>For heatmaps, two plotting strategies are provided. By default, the function <code>simplex_heatmap</code> will fill the triangle with small squares. This is very fast but looks dreadful if the resolution of the heatmap is low, i.e. if there are not very many squares. The other option is to fill the simplex with little triangles, much like the histogramming function does. This tends to produce more visually pleasing results, especially when resolution is low, but is very slow to execute as resolution grows.</p><p>To illustrate these differences, we will plot the pdf (probability density function) of the Dirichlet distribution <code>dir</code> created above, at different resolutions, using the two methods.</p><p>First, the &quot;fast&quot; square method:</p><pre><code class="language-julia hljs">resolution = 0.1
mysequence = 0.0:resolution:1.0

grid = [pdf(dir, [x, y, 1-x-y]) for x in mysequence, y in mysequence]

simplex_heatmap(grid)</code></pre><p><img src="../heat1.png" alt/></p><p>Obviously, filling the triangle with squares is difficult if the squares are too large... However, with higher resolutions this works well:</p><pre><code class="language-julia hljs">resolution = 0.001
mysequence = 0.0:resolution:1.0

grid = [pdf(dir, [x, y, 1-x-y]) for x in mysequence, y in mysequence]

simplex_heatmap(grid)</code></pre><p><img src="../heat2.png" alt/></p><p>By contrast, here is the result when using the slower triangle method. To use this, specify the <code>method = &quot;triangle&quot;</code> keyword argument:</p><pre><code class="language-julia hljs">resolution = 0.02
mysequence = 0.0:resolution:1.0

grid = [pdf(dir, [x, y, 1-x-y]) for x in mysequence, y in mysequence]

simplex_heatmap(grid; method = &quot;triangle&quot;)</code></pre><p><img src="../heat3.png" alt/></p><div class="admonition is-danger"><header class="admonition-header">Danger</header><div class="admonition-body"><p>The <code>method = &quot;triangle&quot;</code> option is experimental. Expect, certainly, long execution times if the heatmap resolution is large, and, possibly, illogical behaviour.</p></div></div><h2 id="Adding-to-plots"><a class="docs-heading-anchor" href="#Adding-to-plots">Adding to plots</a><a id="Adding-to-plots-1"></a><a class="docs-heading-anchor-permalink" href="#Adding-to-plots" title="Permalink"></a></h2><p>SimplexPlots.jl also provides exclamation-marked versions of <code>simplex_plot</code> and <code>simplex_scatter</code>. This means you can add content to an already existing plot. This way we can combine, for instance, the solution of the Rock-Paper-Scissors dynamics and one of the histograms from above:</p><pre><code class="language-julia hljs">simplex_histogram(rand(dir, 10_000);
                  bins=20,
                  vertices = [L&quot;u_1&quot;, L&quot;u_2&quot;, L&quot;u_3&quot;],
                  color = :Pastel1_3)

simplex_plot!(sol.u;
              color = :black,
              linewidth = 3.0,
              label = nothing)</code></pre><p><img src="../combo.png" alt/></p><p>Or we can illustrate several solutions of rock-paper-scissors in a single plot:</p><pre><code class="language-julia hljs">u0 = [0.1, 0.1, 0.8]
prob1 = ODEProblem(replicator, u0, tspan, RPS)

u0 = [0.2, 0.2, 0.6]
prob2 = ODEProblem(replicator, u0, tspan, RPS)

u0 = [0.3, 0.3, 0.4]
prob3 = ODEProblem(replicator, u0, tspan, RPS)

sol1 = solve(prob1, saveat=0.1)
sol2 = solve(prob2, saveat=0.1)
sol3 = solve(prob3, saveat=0.1)

simplex_plot(sol1.u;
             vertices = [L&quot;u_1&quot;, L&quot;u_2&quot;, L&quot;u_3&quot;],
             color = :red,
             linewidth = 3.0,
             label = &quot;solution 1&quot;)

simplex_plot!(sol2.u;
              color = :green,
              linewidth = 3.0,
              label = &quot;solution 2&quot;)

simplex_plot!(sol3.u;
              color = :blue,
              linewidth = 3.0,
              label = &quot;solution 3&quot;)</code></pre><p><img src="../solutions.png" alt/></p><h1 id="Axis-orientation"><a class="docs-heading-anchor" href="#Axis-orientation">Axis orientation</a><a id="Axis-orientation-1"></a><a class="docs-heading-anchor-permalink" href="#Axis-orientation" title="Permalink"></a></h1><p>The vertices of the simplex are labelled using the strings in the <code>vertices</code> keyword argument. By default, this is done counter-clockwise starting from the rightmost vertex. To control this order, each SimplexPlots.jl method – with the exception of <code>simplex_heatmap</code> – accepts an <code>axes</code> keyword argument which specifies the axis order, the default being <code>axes = [1, 2, 3]</code>. Witness:</p><pre><code class="language-julia hljs">mymatrix = [0.1 0.1 0.8
            0.3 0.4 0.3
            0.2 0.6 0.2
            0.1 0.7 0.2
            0.0 0.8 0.2
            0.0 1.0 0.0]

simplex_plot(mymatrix; label=nothing, linewidth=4.0, color=:blue, axes = [1, 2, 3])</code></pre><p><img src="../axes1.png" alt/></p><pre><code class="language-julia hljs">simplex_plot(mymatrix; label=nothing, linewidth=4.0, color=:blue, axes = [2, 1, 3])</code></pre><p><img src="../axes2.png" alt/></p><pre><code class="language-julia hljs">simplex_plot(mymatrix; label=nothing, linewidth=4.0, color=:blue, axes = [3, 1, 2])</code></pre><p><img src="../axes3.png" alt/></p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Changing the vertex labels does not reorder the axes. Only specifying the <code>axes</code> keyword argument does so!</p></div></div><p>With heatmaps, currently the only way of changing the axes is by modifying the input itself, along with the requisite modification to the <code>vertices</code> argument. For instance:</p><pre><code class="language-julia hljs">dir = Dirichlet([9.0, 6.0, 3.0])

resolution = 0.001
mysequence = 0.0:resolution:1.0

grid1 = [pdf(dir, [x, y, 1-x-y]) for x in mysequence, y in mysequence]

simplex_heatmap(grid1; vertices = [&quot;x&quot;, &quot;y&quot;, &quot;z&quot;])</code></pre><p><img src="../heataxes1.png" alt/></p><pre><code class="language-julia hljs">grid2 = [pdf(dir, [y, x, 1-x-y]) for x in mysequence, y in mysequence]

simplex_heatmap(grid2; vertices = [&quot;y&quot;, &quot;x&quot;, &quot;z&quot;])</code></pre><p><img src="../heataxes2.png" alt/></p><pre><code class="language-julia hljs">grid3 = [pdf(dir, [1-y-z, y, z]) for z in mysequence, y in mysequence]

simplex_heatmap(grid3; vertices = [&quot;z&quot;, &quot;y&quot;, &quot;x&quot;])</code></pre><p><img src="../heataxes3.png" alt/></p><p>This is likely to change in a future version.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../reference/">Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.9.0 on <span class="colophon-date" title="Monday 24 March 2025 14:57">Monday 24 March 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
